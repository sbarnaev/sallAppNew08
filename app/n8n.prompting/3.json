https://api.openai.com/v1/responses

{
    "model": "gpt-5-mini",
    "reasoning": { 
      "effort": "medium" 
    },
    "input": [
      {
        "role": "system",
        "content": "Ты — эксперт по системному анализу личности (САЛ), который помогает консультанту провести партнерскую консультацию для пары (двух человек). Твоя задача — создать понятный, ясный, бытовой текст, который консультант сможет легко использовать в работе с парой.\n\nСАЛ — это метод, который определяет ключевые аспекты личности через пять кодов по дате рождения:\n1) Код Личности — ядро человека, его врожденная природа, способ мышления, характер.\n2) Код Коннектора — как человек взаимодействует с миром, как его воспринимают окружающие.\n3) Код Реализации — через что человек реализует себя, получает чувство пользы и результата.\n4) Код Генератора — что заряжает и истощает человека, что даёт смысл.\n5) Код Миссии — какую энергию человек призван нести в мир, испытания и искажения.\n\nВАЖНО: Пиши простым, понятным языком, как будто объясняешь другу. Избегай сложных терминов, используй бытовые примеры и ситуации из жизни.\n\nЖЁСТКОЕ ПРАВИЛО ПО ЦИФРАМ: Всегда указывай цифру кода ресурса из профиля каждого участника, например: \"Личность (1) первого участника\", \"Коннектор (2) второго участника\".\n\nЧто нужно вернуть:\n- Предупреждения (warnings) — какие сложности и проблемы могут быть по профилям САЛ пары в разрезе достижения цели. Пиши коротко, ясно, по делу.\n- Декомпозицию цели пары (goalDecomposition) — из чего состоит большая цель и что нужно для её достижения. Разложи цель на понятные шаги.\n- Ресурсы для этапов (resourcesForStages) — какой ресурс САЛ какого участника нужен на каком этапе и зачем. Указывай ресурс с цифрой и участника, объясняй простым языком.\n- Совместимость ресурсов (compatibility) — какие ресурсы дополняют друг друга, какие конфликтуют, и как это решить.\n- Диагностику пары сейчас (currentDiagnostics) — что в плюсе/минусе у каждого участника, реальная готовность пары, зоны конфликтов. Добавь диагностические вопросы простым языком.\n- План достижения (plan123) — что делать сначала, потом, затем, с указанием кто из участников что делает. Три этапа с конкретными действиями.\n- Метрики прогресса (progressMetrics) — как понять, что пара идёт к цели и что получается. Ранние, средние и итоговые сигналы.\n- Что делать при негативе (whatIf) — усталость, перегруз, конфликты, откаты. Конкретные советы простым языком.\n- Работа с возражениями (objectionHandling) — что может возразить пара и как помочь/ответить.\n- Итоговое резюме (finalStrategy) — как идём к цели, ровно в 3 абзацах простым языком.\n\nСтиль: коротко, ясно, по делу, простым языком."
      },
      {
        "role": "user",
        "content": "Запрос пары: {{ $('Webhook').item.json.body.goal }}\n\nПрофиль первого участника: {{ $('Webhook').item.json.body.name }} {{ $('Webhook').item.json.body.birthday }} {{ $('Call \'Собирает инфу по учебнику\'').item.json.codes[0].description }} {{ $('Call \'Собирает инфу по учебнику\'').item.json.codes[1].description }} {{ $('Call \'Собирает инфу по учебнику\'').item.json.codes[2].description }} {{ $('Call \'Собирает инфу по учебнику\'').item.json.codes[3].description }} {{ $('Call \'Собирает инфу по учебнику\'').item.json.codes[4].description }}\n\n\nПрофиль второго участника: {{ $('Webhook').item.json.body.partnerName }} {{ $('Webhook').item.json.body.partnerBirthday }}\n{{ $json.codes[0].description }} {{ $json.codes[1].description }} {{ $json.codes[2].description }} {{ $json.codes[3].description }} {{ $json.codes[4].description }}"
      }
    ],
    "text": {
      "format": {
        "type": "json_schema",
        "name": "sal_partner_consult_structure",
        "strict": true,
        "schema": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "warnings": {
              "type": "array",
              "description": "Предупреждения — какие сложности и проблемы могут быть по профилям САЛ пары в разрезе достижения цели. Пиши коротко, ясно, по делу, простым языком.",
              "items": { "type": "string" }
            },
            "goalDecomposition": {
              "type": "array",
              "description": "Декомпозиция цели пары — из чего состоит большая цель и что нужно для её достижения. Разложи цель на понятные шаги простым языком.",
              "items": { "type": "string" }
            },
            "resourcesForStages": {
              "type": "array",
              "description": "Ресурсы для этапов — какой ресурс САЛ какого участника нужен на каком этапе и зачем. Указывай ресурс с цифрой и участника, объясняй простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stage": { "type": "string" },
                  "resources": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string" },
                        "code": { "type": "string" },
                        "participant": { "type": "string", "enum": ["first", "second"] },
                        "why": { "type": "string" },
                        "successSignals": { "type": "array", "items": { "type": "string" } }
                      },
                      "required": ["resource","code","participant","why","successSignals"]
                    }
                  }
                },
                "required": ["stage","resources"]
              }
            },
            "compatibility": {
              "type": "object",
              "description": "Совместимость ресурсов — какие ресурсы дополняют друг друга, какие конфликтуют, и как это решить простым языком.",
              "additionalProperties": false,
              "properties": {
                "complementary": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "firstResource": { "type": "string" },
                      "secondResource": { "type": "string" },
                      "why": { "type": "string" }
                    },
                    "required": ["firstResource","secondResource","why"]
                  }
                },
                "conflicts": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "firstResource": { "type": "string" },
                      "secondResource": { "type": "string" },
                      "why": { "type": "string" },
                      "solution": { "type": "string" }
                    },
                    "required": ["firstResource","secondResource","why","solution"]
                  }
                }
              },
              "required": ["complementary","conflicts"]
            },
            "currentDiagnostics": {
              "type": "object",
              "description": "Диагностика пары сейчас — что в плюсе/минусе у каждого участника, реальная готовность пары, зоны конфликтов. Добавь диагностические вопросы простым языком.",
              "additionalProperties": false,
              "properties": {
                "firstParticipant": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "resourceStates": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                          "resource": { "type": "string" },
                          "code": { "type": "string" },
                          "state": { "type": "string", "enum": ["plus","neutral","minus","unknown"] },
                          "evidence": { "type": "array", "items": { "type": "string" } },
                          "correction": { "type": "array", "items": { "type": "string" } }
                        },
                        "required": ["resource","code","state","evidence","correction"]
                      }
                    }
                  },
                  "required": ["resourceStates"]
                },
                "secondParticipant": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "resourceStates": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                          "resource": { "type": "string" },
                          "code": { "type": "string" },
                          "state": { "type": "string", "enum": ["plus","neutral","minus","unknown"] },
                          "evidence": { "type": "array", "items": { "type": "string" } },
                          "correction": { "type": "array", "items": { "type": "string" } }
                        },
                        "required": ["resource","code","state","evidence","correction"]
                      }
                    }
                  },
                  "required": ["resourceStates"]
                },
                "conflictZones": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "zone": { "type": "string" },
                      "description": { "type": "string" },
                      "firstParticipantRole": { "type": "string" },
                      "secondParticipantRole": { "type": "string" },
                      "solution": { "type": "string" }
                    },
                    "required": ["zone","description","firstParticipantRole","secondParticipantRole","solution"]
                  }
                },
                "readiness": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "willingness": { "type": "number", "minimum": 0, "maximum": 10 },
                    "blockers": { "type": "array", "items": { "type": "string" } },
                    "comment": { "type": "string" }
                  },
                  "required": ["willingness","blockers","comment"]
                },
                "questions": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "question": { "type": "string" },
                      "salResource": { "type": "string" },
                      "participant": { "type": "string", "enum": ["first", "second", "both"] }
                    },
                    "required": ["question","salResource","participant"]
                  }
                }
              },
              "required": ["firstParticipant","secondParticipant","conflictZones","readiness","questions"]
            },
            "plan123": {
              "type": "array",
              "description": "План достижения — что делать сначала, потом, затем, с указанием кто из участников что делает. Три этапа с конкретными действиями простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stageTitle": { "type": "string" },
                  "actions": { "type": "array", "items": { "type": "string" } },
                  "resources": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string" },
                        "code": { "type": "string" },
                        "participant": { "type": "string", "enum": ["first", "second"] }
                      },
                      "required": ["resource","code","participant"]
                    }
                  },
                  "successCriteria": { "type": "string" },
                  "riskNotes": { "type": "string" }
                },
                "required": ["stageTitle","actions","resources","successCriteria","riskNotes"]
              }
            },
            "progressMetrics": {
              "type": "object",
              "description": "Метрики прогресса — как понять, что пара идёт к цели и что получается. Ранние, средние и итоговые сигналы простым языком.",
              "additionalProperties": false,
              "properties": {
                "earlySignals": { "type": "array", "items": { "type": "string" } },
                "midSignals": { "type": "array", "items": { "type": "string" } },
                "resultSignals": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["earlySignals","midSignals","resultSignals"]
            },
            "whatIf": {
              "type": "object",
              "description": "Что делать при негативе — усталость, перегруз, конфликты, откаты. Конкретные советы простым языком.",
              "additionalProperties": false,
              "properties": {
                "fatigue": { "type": "array", "items": { "type": "string" } },
                "overwhelm": { "type": "array", "items": { "type": "string" } },
                "conflicts": { "type": "array", "items": { "type": "string" } },
                "relapse": { "type": "array", "items": { "type": "string" } },
                "pitfalls": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["fatigue","overwhelm","conflicts","relapse","pitfalls"]
            },
            "objectionHandling": {
              "type": "array",
              "description": "Работа с возражениями — что может возразить пара и как помочь/ответить простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "objection": { "type": "string" },
                  "reply": { "type": "string" }
                },
                "required": ["objection","reply"]
              }
            },
            "finalStrategy": {
              "type": "array",
              "description": "Итоговое резюме — как идём к цели, ровно в 3 абзацах простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": { "type": "string" }
            }
          },
          "required": [
            "warnings",
            "goalDecomposition",
            "resourcesForStages",
            "compatibility",
            "currentDiagnostics",
            "plan123",
            "progressMetrics",
            "whatIf",
            "objectionHandling",
            "finalStrategy"
          ]
        }
      }
    }
  }