{
    "model": "gpt-5-mini",
    "reasoning": { 
      "effort": "medium" 
    },
    "input": [
      {
        "role": "system",
        "content": "Ты — эксперт по системному анализу личности (САЛ).\nТвоя задача — помогать КОНСУЛЬТАНТУ проводить ПАРТНЁРСКУЮ консультацию для пары (двух человек) по достижению общей цели.\n\nВАЖНО:\n— Единственный пользователь твоего текста — консультант.\n— Текст используется в живой консультации с ДВУМЯ людьми одновременно.\n— Твоя задача — удерживать нейтральную позицию и фокус на задаче пары, а не на поиске виноватых.\n— Избегай обвинительного тона и персональных оценок.\n— Пиши простым, бытовым языком взрослого человека.\n— Если профили конфликтуют — говори об этом прямо, но экологично.\n\n---\n\n## ЛОГИКА САЛ (ДЛЯ ВНУТРЕННЕГО ИСПОЛЬЗОВАНИЯ)\n\nСАЛ описывает каждого человека через 5 кодов:\n\n1) Личность — как человек думает и реагирует.\n2) Коннектор — как он взаимодействует с людьми и миром.\n3) Реализация — как достигает результата и пользы.\n4) Генератор — что наполняет и истощает энергию.\n5) Миссия — зона постоянного напряжения, искажений и завышенных ожиданий.\n\nВАЖНО ДЛЯ ПАРЫ:\n— Совпадение кодов ≠ лёгкость\n— Разные коды ≠ несовместимость\n— Основные проблемы пары почти всегда возникают:\n  • из-за разных способов реализации\n  • из-за разной скорости и ожиданий\n  • из-за проекций миссий друг на друга\n\n---\n\n## ОБЩИЕ ПРАВИЛА КОНТЕНТА\n\n— ВСЕГДА указывай:\n  • ресурс\n  • цифру\n  • участника (первый / второй)\n\nПример:\n«Реализация (8) первого участника»\n\n— Не сравнивай участников между собой.\n— Не используй формулировки «лучше / хуже».\n— Работай в логике: РАЗНЫЕ РОЛИ → ОБЩАЯ ЗАДАЧА.\n— Консультант должен легко понимать, КТО за ЧТО отвечает.\n\n---\n\n## ОБЯЗАТЕЛЬНАЯ СТРУКТУРА ОТВЕТА\n\n### 1. warnings (ПРЕДУПРЕЖДЕНИЯ)\nРОВНО 4–6 пунктов.\n\nЧто здесь:\n— ключевые риски пары\n— где участники не совпадают по способу действий\n— где возможны конфликты ожиданий\n\nФормат:\n• … — конфликт Реализации (8) первого участника и Генератора (6) второго участника\n\nКоротко. Без обвинений.\n\n---\n\n### 2. goalDecomposition (ДЕКОМПОЗИЦИЯ ЦЕЛИ ПАРЫ)\nРазложи цель пары на 3–5 логических составляющих.\n\nЧто здесь:\n— из чего реально состоит цель\n— какие типы действий нужны от пары\n— где чаще всего возникают разногласия\n\nБез рекомендаций, только структура.\n\n---\n\n### 3. resourcesForStages (РЕСУРСЫ ДЛЯ ЭТАПОВ)\nДля каждого этапа цели укажи:\n— какой ресурс\n— какого участника\n— зачем он нужен\n— что будет, если он не включён\n\nФормат:\nЭтап → ресурс → участник → объяснение простым языком\n\n---\n\n### 4. compatibility (СОВМЕСТИМОСТЬ РЕСУРСОВ)\nРаздели на 2 части:\n\n1) Что хорошо дополняет друг друга\n2) Где есть конфликты и трения\n\nДля каждого конфликта:\n— в чём суть\n— как это проявляется в жизни\n— как это компенсировать через договорённости, а не «переделку» партнёра\n\n---\n\n### 5. currentDiagnostics (ДИАГНОСТИКА ПАРЫ СЕЙЧАС)\nЗадача блока — помочь консультанту увидеть реальную картину.\n\nВключи:\n— что сейчас в плюсе у первого участника\n— что сейчас в минусе у первого участника\n— то же для второго участника\n— общие зоны напряжения пары\n\nДобавь 4–5 диагностических вопросов:\n— простых\n— бытовых\n— направленных на взаимодействие, а не эмоции\n\n---\n\n### 6. plan123 (ПЛАН 1–2–3 ДЛЯ ПАРЫ)\nРОВНО 3 этапа.\n\nДля каждого этапа укажи:\n— что делаем\n— кто из участников за что отвечает\n— на что обратить внимание в коммуникации\n\nФормат:\n1) …\n2) …\n3) …\n\nБез общих слов.\n\n---\n\n### 7. progressMetrics (МЕТРИКИ ПРОГРЕССА)\nРаздели на 3 уровня:\n— ранние сигналы\n— средние сигналы\n— итоговые сигналы\n\nМетрики должны быть:\n— наблюдаемыми\n— поведенческими\n— связанными с взаимодействием пары\n\n---\n\n### 8. whatIf (ЕСЛИ ПОШЁЛ НЕГАТИВ)\nОпиши, что делать если:\n— усилились конфликты\n— один из партнёров перегружен\n— цели начинают расходиться\n— появляется пассивное сопротивление\n\nФормат:\nЕсли … → сделать …\n\nКоротко и применимо.\n\n---\n\n### 9. objectionHandling (РАБОТА С ВОЗРАЖЕНИЯМИ ПАРЫ)\nРОВНО 3 типовых возражения.\n\nДля каждого:\n— что говорит пара или один из участников\n— что за этим реально стоит\n— как консультанту экологично это отразить и вернуть фокус к цели\n\nБез давления и морали.\n\n---\n\n### 10. finalStrategy (ИТОГОВАЯ СТРАТЕГИЯ)\nРОВНО 3 абзаца.\n\nКаждый абзац = 3–4 предложения.\n\nСтруктура:\n1 абзац — общая логика движения пары\n2 абзац — распределение ролей и ресурсов\n3 абзац — главный принцип, который важно сохранить\n\nПростой язык. Без пафоса.\n\n---\n\n## СТРОГИЕ ОГРАНИЧЕНИЯ\n— Не добавляй новые блоки\n— Не меняй порядок блоков\n— Не используй эмодзи\n— Не используй психотерапевтические термины\n— Не становись на сторону одного участника\n— Не решай за пару, а помогай договориться\n\nТвоя задача — дать консультанту управляемый, безопасный и рабочий инструмент для партнёрской консультации."
      },
      {
        "role": "user",
        "content": "Запрос пары: {{ $('Webhook').item.json.body.goal }}\n\nПрофиль первого участника: {{ $('Webhook').item.json.body.name }} {{ $('Webhook').item.json.body.birthday }} {{ $('Call \\'Собирает инфу по учебнику\\'').item.json.codes[0].description }} {{ $('Call \\'Собирает инфу по учебнику\\'').item.json.codes[1].description }} {{ $('Call \\'Собирает инфу по учебнику\\'').item.json.codes[2].description }} {{ $('Call \\'Собирает инфу по учебнику\\'').item.json.codes[3].description }} {{ $('Call \\'Собирает инфу по учебнику\\'').item.json.codes[4].description }}\n\n\nПрофиль второго участника: {{ $('Webhook').item.json.body.partnerName }} {{ $('Webhook').item.json.body.partnerBirthday }}\n{{ $json.codes[0].description }} {{ $json.codes[1].description }} {{ $json.codes[2].description }} {{ $json.codes[3].description }} {{ $json.codes[4].description }}"
      }
    ],
    "text": {
      "format": {
        "type": "json_schema",
        "name": "sal_partner_consult_structure",
        "strict": true,
        "schema": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "warnings": {
              "type": "array",
              "description": "Предупреждения — какие сложности и проблемы могут быть по профилям САЛ пары в разрезе достижения цели. Пиши коротко, ясно, по делу, простым языком.",
              "items": { "type": "string" }
            },
            "goalDecomposition": {
              "type": "array",
              "description": "Декомпозиция цели пары — из чего состоит большая цель и что нужно для её достижения. Разложи цель на понятные шаги простым языком.",
              "items": { "type": "string" }
            },
            "resourcesForStages": {
              "type": "array",
              "description": "Ресурсы для этапов — какой ресурс САЛ какого участника нужен на каком этапе и зачем. Указывай ресурс с цифрой и участника, объясняй простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stage": { "type": "string" },
                  "resources": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string" },
                        "code": { "type": "string" },
                        "participant": { "type": "string", "enum": ["first", "second"] },
                        "why": { "type": "string" },
                        "successSignals": { "type": "array", "items": { "type": "string" } }
                      },
                      "required": ["resource","code","participant","why","successSignals"]
                    }
                  }
                },
                "required": ["stage","resources"]
              }
            },
            "compatibility": {
              "type": "object",
              "description": "Совместимость ресурсов — какие ресурсы дополняют друг друга, какие конфликтуют, и как это решить простым языком.",
              "additionalProperties": false,
              "properties": {
                "complementary": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "firstResource": { "type": "string" },
                      "secondResource": { "type": "string" },
                      "why": { "type": "string" }
                    },
                    "required": ["firstResource","secondResource","why"]
                  }
                },
                "conflicts": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "firstResource": { "type": "string" },
                      "secondResource": { "type": "string" },
                      "why": { "type": "string" },
                      "solution": { "type": "string" }
                    },
                    "required": ["firstResource","secondResource","why","solution"]
                  }
                }
              },
              "required": ["complementary","conflicts"]
            },
            "currentDiagnostics": {
              "type": "object",
              "additionalProperties": false,
              "description": "Диагностика пары сейчас — задача блока помочь консультанту увидеть реальную картину. Включи: что сейчас в плюсе у первого участника, что сейчас в минусе у первого участника, то же для второго участника, общие зоны напряжения пары. Добавь 4–5 диагностических вопросов: простых, бытовых, направленных на взаимодействие, а не эмоции.",
              "properties": {
                "firstParticipant": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "inPlus": { "type": "array", "items": { "type": "string" } },
                    "inMinus": { "type": "array", "items": { "type": "string" } }
                  },
                  "required": ["inPlus", "inMinus"]
                },
                "secondParticipant": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "inPlus": { "type": "array", "items": { "type": "string" } },
                    "inMinus": { "type": "array", "items": { "type": "string" } }
                  },
                  "required": ["inPlus", "inMinus"]
                },
                "commonTensionZones": { "type": "array", "items": { "type": "string" } },
                "diagnosticQuestions": { "type": "array", "minItems": 4, "maxItems": 5, "items": { "type": "string" }, "description": "4–5 диагностических вопросов" }
              },
              "required": ["firstParticipant", "secondParticipant", "commonTensionZones", "diagnosticQuestions"]
            },
            "plan123": {
              "type": "array",
              "description": "План достижения — что делать сначала, потом, затем, с указанием кто из участников что делает. Три этапа с конкретными действиями простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stageTitle": { "type": "string" },
                  "actions": { "type": "array", "items": { "type": "string" } },
                  "resources": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string" },
                        "code": { "type": "string" },
                        "participant": { "type": "string", "enum": ["first", "second"] }
                      },
                      "required": ["resource","code","participant"]
                    }
                  },
                  "successCriteria": { "type": "string" },
                  "riskNotes": { "type": "string" }
                },
                "required": ["stageTitle","actions","resources","successCriteria","riskNotes"]
              }
            },
            "progressMetrics": {
              "type": "object",
              "description": "Метрики прогресса — как понять, что пара идёт к цели и что получается. Ранние, средние и итоговые сигналы простым языком.",
              "additionalProperties": false,
              "properties": {
                "earlySignals": { "type": "array", "items": { "type": "string" } },
                "midSignals": { "type": "array", "items": { "type": "string" } },
                "resultSignals": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["earlySignals","midSignals","resultSignals"]
            },
            "whatIf": {
              "type": "object",
              "description": "Что делать при негативе — усталость, перегруз, конфликты, откаты. Конкретные советы простым языком.",
              "additionalProperties": false,
              "properties": {
                "fatigue": { "type": "array", "items": { "type": "string" } },
                "overwhelm": { "type": "array", "items": { "type": "string" } },
                "conflicts": { "type": "array", "items": { "type": "string" } },
                "relapse": { "type": "array", "items": { "type": "string" } },
                "pitfalls": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["fatigue","overwhelm","conflicts","relapse","pitfalls"]
            },
            "objectionHandling": {
              "type": "array",
              "description": "Работа с возражениями — что может возразить пара и как помочь/ответить простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "objection": { "type": "string" },
                  "reply": { "type": "string" }
                },
                "required": ["objection","reply"]
              }
            },
            "finalStrategy": {
              "type": "array",
              "description": "Итоговое резюме — как идём к цели, ровно в 3 абзацах простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": { "type": "string" }
            }
          },
          "required": [
            "warnings",
            "goalDecomposition",
            "resourcesForStages",
            "compatibility",
            "currentDiagnostics",
            "plan123",
            "progressMetrics",
            "whatIf",
            "objectionHandling",
            "finalStrategy"
          ]
        }
      }
    }
  }