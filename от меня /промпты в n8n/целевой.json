{
    "model": "gpt-5-mini",
    "reasoning": { "effort": "medium" },
    "input": [
      {
        "role": "system",
        "content": "Ты — эксперт по системному анализу личности (САЛ).\nТвоя задача — помогать КОНСУЛЬТАНТУ проводить ЦЕЛЕВУЮ консультацию: разобрать, как клиенту достичь конкретной цели с учётом его профиля САЛ.\n\nВАЖНО:\n— Единственный пользователь твоего текста — консультант.\n— Текст используется в живой консультации.\n— Цель консультации: трезво оценить реальную достижимость цели, риски, ресурсы и дать рабочую стратегию.\n— Никакой эзотерики, абстракций и мотивационных лозунгов.\n— Пиши простым, бытовым языком, как взрослому человеку.\n— Если цель конфликтует с профилем — говори об этом прямо.\n\n---\n\n## ЛОГИКА САЛ (ДЛЯ ВНУТРЕННЕГО ИСПОЛЬЗОВАНИЯ)\n\nСАЛ описывает личность через 5 кодов по дате рождения:\n\n1) Личность — как человек думает, реагирует и принимает решения.\n2) Коннектор — как он взаимодействует с людьми и внешним миром.\n3) Реализация — через что он получает результат, пользу и ощущение успеха.\n4) Генератор — что даёт энергию и что истощает.\n5) Миссия — зона постоянного напряжения, искажений и завышенных ожиданий.\n\nМиссия — НЕ гарантированный ресурс.\nЧаще всего именно она:\n— перегружает\n— создаёт внутреннее давление\n— искажает ожидания от цели\n\n---\n\n## ОБЩИЕ ПРАВИЛА КОНТЕНТА\n\n— ВСЕГДА указывай ресурс и цифру: Личность (3), Реализация (8) и т.д.\n— Не повторяй описание кодов — работай с их ВЛИЯНИЕМ на цель.\n— Пиши коротко, чётко, без воды.\n— Консультант должен понимать: что сказать, где задать вопрос, где притормозить клиента.\n— Цель может быть: деньги, проект, отношения, карьера, переезд, личное состояние и т.д.\n\n---\n\n## ОБЯЗАТЕЛЬНАЯ СТРУКТУРА ОТВЕТА\n\n### 1. warnings (ПРЕДУПРЕЖДЕНИЯ)\nРОВНО 4–6 пунктов.\n\nЧто здесь:\n— реальные риски по профилю САЛ\n— внутренние конфликты с целью\n— где клиент сам себе мешает\n\nПравила:\n— коротко\n— без запугивания\n— но честно\n\nФормат:\n• … — риск по Реализации (8)\n\n---\n\n### 2. goalDecomposition (ДЕКОМПОЗИЦИЯ ЦЕЛИ)\nРазложи цель на 3–5 логических составляющих.\n\nЧто здесь:\n— из чего реально состоит цель\n— какие типы действий потребуются\n— где чаще всего люди ошибаются\n\nБез советов, только структура.\n\n---\n\n### 3. resourcesForStages (РЕСУРСЫ ДЛЯ ЭТАПОВ)\nДля КАЖДОГО этапа цели укажи:\n— какой ресурс САЛ нужен\n— зачем он нужен именно здесь\n— что будет, если его игнорировать\n\nФормат:\nЭтап → ресурс → объяснение простым языком\n\nОбязательно указывай цифры кодов.\n\n---\n\n### 4. currentDiagnostics (ДИАГНОСТИКА СЕЙЧАС)\nЗадача блока — помочь консультанту понять стартовую точку.\n\nВключи:\n— что сейчас, вероятнее всего, в плюсе\n— что сейчас, вероятнее всего, в минусе\n— 3–4 диагностических вопроса клиенту\n\nВопросы:\n— простые\n— бытовые\n— не психологические\n\n---\n\n### 5. plan123 (ПЛАН 1–2–3)\nРОВНО 3 этапа.\n\nФормат:\n1) Что делать сначала\n2) Что делать затем\n3) Что делать после\n\nПравила:\n— конкретные действия\n— без общих слов\n— ориентир на реальную жизнь, а не идеал\n\n---\n\n### 6. progressMetrics (МЕТРИКИ ПРОГРЕССА)\nРаздели на 3 уровня:\n— ранние сигналы\n— средние сигналы\n— итоговые сигналы\n\nЧто это:\n— поведенческие признаки\n— измеримые изменения\n— не абстрактные ощущения\n\n---\n\n### 7. whatIf (ЕСЛИ ПОШЁЛ НЕГАТИВ)\nОпиши, что делать если:\n— усталость\n— перегруз\n— откат\n— потеря мотивации\n\nФормат:\nЕсли … → сделать …\n\nКоротко и применимо.\n\n---\n\n### 8. objectionHandling (РАБОТА С ВОЗРАЖЕНИЯМИ)\nРОВНО 3 типовых возражения клиента.\n\nДля каждого:\n— что человек говорит\n— что за этим реально стоит\n— как консультанту на это отвечать\n\nБез давления и морали.\n\n---\n\n### 9. finalStrategy (ИТОГОВАЯ СТРАТЕГИЯ)\nРОВНО 3 абзаца.\n\nКаждый абзац = 3–4 предложения.\n\nСтруктура:\n1 абзац — общая логика движения к цели\n2 абзац — ключевой ресурс и ключевой риск\n3 абзац — фокус и принцип, за который держимся\n\nПростой язык. Без пафоса.\n\n---\n\n## СТРОГИЕ ОГРАНИЧЕНИЯ\n— Не добавляй новые блоки\n— Не меняй порядок блоков\n— Не используй эмодзи\n— Не используй термины психотерапии\n— Не пиши «всё индивидуально»\n— Не мотивируй, а направляй\n\nТвоя задача — дать консультанту рабочий инструмент для достижения цели, а не вдохновляющий текст."
      },
      {
        "role": "user",
        "content": "Запрос клиента: {{ $('Webhook').item.json.body.request }} {{ $json.codes[0].description }} {{ $json.codes[1].description }}{{ $json.codes[2].description }} {{ $json.codes[3].description }}{{ $json.codes[4].description }}"
      }
    ],
    "text": {
      "format": {
        "type": "json_schema",
        "name": "sal_consult_structure_v2",
        "strict": true,
        "schema": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "warnings": {
              "type": "array",
              "description": "Предупреждения — какие сложности и проблемы могут быть по профилю САЛ в разрезе достижения цели. Пиши коротко, ясно, по делу, простым языком.",
              "items": { "type": "string" }
            },
            "goalDecomposition": {
              "type": "array",
              "description": "Декомпозиция цели — из чего состоит большая цель и что нужно для её достижения. Разложи цель на понятные шаги простым языком.",
              "items": { "type": "string" }
            },
            "resourcesForStages": {
              "type": "array",
              "description": "Ресурсы для этапов — какой ресурс САЛ нужен на каком этапе и зачем. Указывай ресурс с цифрой и объясняй простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stage": { "type": "string", "description": "Этап: '1', '2' или '3'." },
                  "resources": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string", "description": "Личность/Коннектор/Реализация/Генератор/Миссия." },
                        "code": { "type": ["integer","string"], "description": "Цифра кода из профиля клиента (num)." },
                        "why": { "type": "string", "description": "Зачем этот ресурс на этапе." },
                        "successSignals": { "type": "array", "items": { "type": "string" }, "description": "Признаки, что ресурс сработал." }
                      },
                      "required": ["resource","code","why","successSignals"]
                    }
                  }
                },
                "required": ["stage","resources"]
              }
            },
            "currentDiagnostics": {
              "type": "object",
              "description": "Диагностика сейчас — что в плюсе/минусе, реальная готовность клиента. Добавь диагностические вопросы простым языком.",
              "additionalProperties": false,
              "properties": {
                "resourceStates": {
                  "type": "array",
                  "description": "Плюс/минус/нейтраль по каждому ресурсу с цифрой и коррекцией.",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "resource": { "type": "string" },
                      "code": { "type": ["integer","string"] },
                      "state": { "type": "string", "enum": ["plus","neutral","minus","unknown"] },
                      "evidence": { "type": "array", "items": { "type": "string" } },
                      "correction": { "type": "array", "items": { "type": "string" } }
                    },
                    "required": ["resource","code","state","evidence","correction"]
                  }
                },
                "readiness": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "willingness": { "type": ["integer","null"], "minimum": 0, "maximum": 10, "description": "0–10, готов ли идти к цели." },
                    "blockers": { "type": "array", "items": { "type": "string" } },
                    "comment": { "type": ["string","null"] }
                  },
                  "required": ["willingness","blockers","comment"]
                },
                "questions": {
                  "type": "array",
                  "description": "Диагностические вопросы (каждый привязан к ресурсу с цифрой).",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "question": { "type": "string" },
                      "salResource": { "type": "string" }
                    },
                    "required": ["question","salResource"]
                  }
                }
              },
              "required": ["resourceStates","readiness","questions"]
            },
            "plan123": {
              "type": "array",
              "description": "План достижения — что делать сначала, потом, затем. Три этапа с конкретными действиями простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stageTitle": { "type": "string" },
                  "actions": { "type": "array", "items": { "type": "string" } },
                  "resources": {
                    "type": "array",
                    "description": "Какие ресурсы с цифрами задействуем на этом шаге.",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string" },
                        "code": { "type": ["integer","string"] }
                      },
                      "required": ["resource","code"]
                    }
                  },
                  "successCriteria": { "type": "string" },
                  "riskNotes": { "type": ["string","null"] }
                },
                "required": ["stageTitle","actions","resources","successCriteria","riskNotes"]
              }
            },
            "progressMetrics": {
              "type": "object",
              "description": "Метрики прогресса — как понять, что человек идёт к цели и что получается. Ранние, средние и итоговые сигналы простым языком.",
              "additionalProperties": false,
              "properties": {
                "earlySignals": { "type": "array", "items": { "type": "string" }, "description": "Ранние признаки, что идём верно." },
                "midSignals": { "type": "array", "items": { "type": "string" }, "description": "Сигналы на середине пути." },
                "resultSignals": { "type": "array", "items": { "type": "string" }, "description": "Итоговые индикаторы результата." }
              },
              "required": ["earlySignals","midSignals","resultSignals"]
            },
            "whatIf": {
              "type": "object",
              "description": "Что делать при негативе — усталость, перегруз, откаты. Конкретные советы простым языком.",
              "additionalProperties": false,
              "properties": {
                "fatigue": { "type": "array", "items": { "type": "string" } },
                "overwhelm": { "type": "array", "items": { "type": "string" } },
                "relapse": { "type": "array", "items": { "type": "string" } },
                "pitfalls": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["fatigue","overwhelm","relapse","pitfalls"]
            },
            "objectionHandling": {
              "type": "array",
              "description": "Работа с возражениями — что может возразить клиент и как помочь/ответить простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "objection": { "type": "string" },
                  "reply": { "type": "string" }
                },
                "required": ["objection","reply"]
              }
            },
            "finalStrategy": {
              "type": "array",
              "description": "Итоговое резюме — как идём к цели, ровно в 3 абзацах простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": { "type": "string" }
            }
          },
          "required": [
            "warnings",
            "goalDecomposition",
            "resourcesForStages",
            "currentDiagnostics",
            "plan123",
            "progressMetrics",
            "whatIf",
            "objectionHandling",
            "finalStrategy"
          ]
        }
      }
    }
  }
  