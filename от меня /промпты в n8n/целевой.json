{
    "model": "gpt-5-mini",
    "reasoning": { "effort": "medium" },
    "input": [
      {
        "role": "system",
        "content": "Ты — эксперт по системному анализу личности (САЛ), который помогает консультанту провести целевую консультацию для клиента. Твоя задача — создать понятный, ясный, бытовой текст, который консультант сможет легко использовать в работе с клиентом.\n\nСАЛ — это метод, который определяет ключевые аспекты личности через пять кодов по дате рождения:\n1) Код Личности — ядро человека, его врожденная природа, способ мышления, характер.\n2) Код Коннектора — как человек взаимодействует с миром, как его воспринимают окружающие.\n3) Код Реализации — через что человек реализует себя, получает чувство пользы и результата.\n4) Код Генератора — что заряжает и истощает человека, что даёт смысл.\n5) Код Миссии — какую энергию человек призван нести в мир, испытания и искажения.\n\nВАЖНО: Пиши простым, понятным языком, как будто объясняешь другу. Избегай сложных терминов, используй бытовые примеры и ситуации из жизни.\n\nЖЁСТКОЕ ПРАВИЛО ПО ЦИФРАМ: Всегда указывай цифру кода ресурса из профиля клиента, например: \"Личность (1)\", \"Коннектор (2)\".\n\nЧто нужно вернуть:\n- Предупреждения (warnings) — какие сложности и проблемы могут быть по профилю САЛ в разрезе достижения цели. Пиши коротко, ясно, по делу.\n- Декомпозицию цели (goalDecomposition) — из чего состоит большая цель и что нужно для её достижения. Разложи цель на понятные шаги.\n- Ресурсы для этапов (resourcesForStages) — какой ресурс САЛ нужен на каком этапе и зачем. Указывай ресурс с цифрой и объясняй простым языком.\n- Диагностику сейчас (currentDiagnostics) — что в плюсе/минусе, реальная готовность клиента. Добавь диагностические вопросы простым языком.\n- План достижения (plan123) — что делать сначала, потом, затем. Три этапа с конкретными действиями.\n- Метрики прогресса (progressMetrics) — как понять, что человек идёт к цели и что получается. Ранние, средние и итоговые сигналы.\n- Что делать при негативе (whatIf) — усталость, перегруз, откаты. Конкретные советы простым языком.\n- Работа с возражениями (objectionHandling) — что может возразить клиент и как помочь/ответить.\n- Итоговое резюме (finalStrategy) — как идём к цели, ровно в 3 абзацах простым языком.\n\nСтиль: коротко, ясно, по делу, простым языком."
      },
      {
        "role": "user",
        "content": "Запрос клиента: {{ $('Webhook').item.json.body.request }} {{ $json.codes[0].description }} {{ $json.codes[1].description }}{{ $json.codes[2].description }} {{ $json.codes[3].description }}{{ $json.codes[4].description }}"
      }
    ],
    "text": {
      "format": {
        "type": "json_schema",
        "name": "sal_consult_structure_v2",
        "strict": true,
        "schema": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "warnings": {
              "type": "array",
              "description": "Предупреждения — какие сложности и проблемы могут быть по профилю САЛ в разрезе достижения цели. Пиши коротко, ясно, по делу, простым языком.",
              "items": { "type": "string" }
            },
            "goalDecomposition": {
              "type": "array",
              "description": "Декомпозиция цели — из чего состоит большая цель и что нужно для её достижения. Разложи цель на понятные шаги простым языком.",
              "items": { "type": "string" }
            },
            "resourcesForStages": {
              "type": "array",
              "description": "Ресурсы для этапов — какой ресурс САЛ нужен на каком этапе и зачем. Указывай ресурс с цифрой и объясняй простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stage": { "type": "string", "description": "Этап: '1', '2' или '3'." },
                  "resources": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string", "description": "Личность/Коннектор/Реализация/Генератор/Миссия." },
                        "code": { "type": ["integer","string"], "description": "Цифра кода из профиля клиента (num)." },
                        "why": { "type": "string", "description": "Зачем этот ресурс на этапе." },
                        "successSignals": { "type": "array", "items": { "type": "string" }, "description": "Признаки, что ресурс сработал." }
                      },
                      "required": ["resource","code","why","successSignals"]
                    }
                  }
                },
                "required": ["stage","resources"]
              }
            },
            "currentDiagnostics": {
              "type": "object",
              "description": "Диагностика сейчас — что в плюсе/минусе, реальная готовность клиента. Добавь диагностические вопросы простым языком.",
              "additionalProperties": false,
              "properties": {
                "resourceStates": {
                  "type": "array",
                  "description": "Плюс/минус/нейтраль по каждому ресурсу с цифрой и коррекцией.",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "resource": { "type": "string" },
                      "code": { "type": ["integer","string"] },
                      "state": { "type": "string", "enum": ["plus","neutral","minus","unknown"] },
                      "evidence": { "type": "array", "items": { "type": "string" } },
                      "correction": { "type": "array", "items": { "type": "string" } }
                    },
                    "required": ["resource","code","state","evidence","correction"]
                  }
                },
                "readiness": {
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "willingness": { "type": ["integer","null"], "minimum": 0, "maximum": 10, "description": "0–10, готов ли идти к цели." },
                    "blockers": { "type": "array", "items": { "type": "string" } },
                    "comment": { "type": ["string","null"] }
                  },
                  "required": ["willingness","blockers","comment"]
                },
                "questions": {
                  "type": "array",
                  "description": "Диагностические вопросы (каждый привязан к ресурсу с цифрой).",
                  "items": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "question": { "type": "string" },
                      "salResource": { "type": "string" }
                    },
                    "required": ["question","salResource"]
                  }
                }
              },
              "required": ["resourceStates","readiness","questions"]
            },
            "plan123": {
              "type": "array",
              "description": "План достижения — что делать сначала, потом, затем. Три этапа с конкретными действиями простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "stageTitle": { "type": "string" },
                  "actions": { "type": "array", "items": { "type": "string" } },
                  "resources": {
                    "type": "array",
                    "description": "Какие ресурсы с цифрами задействуем на этом шаге.",
                    "items": {
                      "type": "object",
                      "additionalProperties": false,
                      "properties": {
                        "resource": { "type": "string" },
                        "code": { "type": ["integer","string"] }
                      },
                      "required": ["resource","code"]
                    }
                  },
                  "successCriteria": { "type": "string" },
                  "riskNotes": { "type": ["string","null"] }
                },
                "required": ["stageTitle","actions","resources","successCriteria","riskNotes"]
              }
            },
            "progressMetrics": {
              "type": "object",
              "description": "Метрики прогресса — как понять, что человек идёт к цели и что получается. Ранние, средние и итоговые сигналы простым языком.",
              "additionalProperties": false,
              "properties": {
                "earlySignals": { "type": "array", "items": { "type": "string" }, "description": "Ранние признаки, что идём верно." },
                "midSignals": { "type": "array", "items": { "type": "string" }, "description": "Сигналы на середине пути." },
                "resultSignals": { "type": "array", "items": { "type": "string" }, "description": "Итоговые индикаторы результата." }
              },
              "required": ["earlySignals","midSignals","resultSignals"]
            },
            "whatIf": {
              "type": "object",
              "description": "Что делать при негативе — усталость, перегруз, откаты. Конкретные советы простым языком.",
              "additionalProperties": false,
              "properties": {
                "fatigue": { "type": "array", "items": { "type": "string" } },
                "overwhelm": { "type": "array", "items": { "type": "string" } },
                "relapse": { "type": "array", "items": { "type": "string" } },
                "pitfalls": { "type": "array", "items": { "type": "string" } }
              },
              "required": ["fatigue","overwhelm","relapse","pitfalls"]
            },
            "objectionHandling": {
              "type": "array",
              "description": "Работа с возражениями — что может возразить клиент и как помочь/ответить простым языком.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "objection": { "type": "string" },
                  "reply": { "type": "string" }
                },
                "required": ["objection","reply"]
              }
            },
            "finalStrategy": {
              "type": "array",
              "description": "Итоговое резюме — как идём к цели, ровно в 3 абзацах простым языком.",
              "minItems": 3,
              "maxItems": 3,
              "items": { "type": "string" }
            }
          },
          "required": [
            "warnings",
            "goalDecomposition",
            "resourcesForStages",
            "currentDiagnostics",
            "plan123",
            "progressMetrics",
            "whatIf",
            "objectionHandling",
            "finalStrategy"
          ]
        }
      }
    }
  }
  