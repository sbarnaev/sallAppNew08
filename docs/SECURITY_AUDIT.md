# –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ:

### 1. **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤**
- ‚úÖ –¢–æ–∫–µ–Ω—ã –≤ `httpOnly` cookies (–Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ JavaScript)
- ‚úÖ `secure` —Ñ–ª–∞–≥ –≤ production (—Ç–æ–ª—å–∫–æ HTTPS)
- ‚úÖ `sameSite: "lax"` (–∑–∞—â–∏—Ç–∞ –æ—Ç CSRF)
- ‚úÖ –¢–æ–∫–µ–Ω—ã –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ URL –∏–ª–∏ localStorage

### 2. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- ‚úÖ –í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–æ–∫–µ–Ω
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω—ã Directus (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)

### 3. **–ó–∞—â–∏—Ç–∞ API**
- ‚úÖ –í—Å–µ API —Ä–æ—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–µ–∑ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

### 1. **XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (–ö–†–ò–¢–ò–ß–ù–û)**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `dangerouslySetInnerHTML` –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏

```typescript
// app/(protected)/profiles/[id]/page.tsx:2775
<div className="card" dangerouslySetInnerHTML={{ __html: String(html) }} />
```

**–†–∏—Å–∫:** HTML –∏–∑ Directus –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ HTML (–Ω–∞–ø—Ä–∏–º–µ—Ä, DOMPurify)

### 2. **–î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ —Ç–æ–∫–µ–Ω—ã (10 –ª–µ—Ç)**

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è 10 –ª–µ—Ç - –µ—Å–ª–∏ cookie —É–∫—Ä–∞–¥–µ–Ω–∞, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∏—Ç –¥–æ–ª–≥–∏–π –¥–æ—Å—Ç—É–ø

**–†–∏—Å–∫:** 
- –ü—Ä–∏ XSS –∞—Ç–∞–∫–µ –º–æ–∂–Ω–æ —É–∫—Ä–∞—Å—Ç—å refresh token —á–µ—Ä–µ–∑ document.cookie (–Ω–æ httpOnly –∑–∞—â–∏—â–∞–µ—Ç)
- –ü—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω –±—É–¥–µ—Ç –≤–∞–ª–∏–¥–µ–Ω 10 –ª–µ—Ç

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –£–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –¥–æ 30-90 –¥–Ω–µ–π
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ (—á–µ—Ä–µ–∑ Directus)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è" –æ–ø—Ü–∏—é (–∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –¥–æ–ª–≥–∏–µ - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 3. **–ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ `console.log` —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
- –¢–æ–∫–µ–Ω—ã (—á–∞—Å—Ç–∏—á–Ω–æ)
- URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º–∏ —Å—Ç–µ–∫–∞–º–∏

**–†–∏—Å–∫:** –õ–æ–≥–∏ –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –≤ production –∏ —Ä–∞—Å–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

**–†–µ—à–µ–Ω–∏–µ:** 
- –£–±—Ä–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–∏—Å–∫:** 
- Brute force –∞—Ç–∞–∫–∏ –Ω–∞ `/api/login`
- DDoS –∞—Ç–∞–∫–∏
- –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ API

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å rate limiting (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ middleware –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)

### 5. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —Å—Ç—Ä–æ–≥–æ

**–ü—Ä–∏–º–µ—Ä—ã:**
- ID –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ `isNaN`, –Ω–æ –Ω–µ –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
- –°—Ç—Ä–æ–∫–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –¥–ª–∏–Ω—É
- –ù–µ—Ç —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 6. **CSRF –∑–∞—â–∏—Ç–∞**

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** `sameSite: "lax"` –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ CSRF –∞—Ç–∞–∫, –Ω–æ –Ω–µ –æ—Ç –≤—Å–µ—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (DELETE, PATCH) –¥–æ–±–∞–≤–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã

### 7. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Content Security Policy (CSP)**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç CSP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

**–†–∏—Å–∫:** XSS –∞—Ç–∞–∫–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ `next.config.mjs`

## üìã –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã):

### –ö—Ä–∏—Ç–∏—á–Ω–æ (—Å–¥–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):
1. ‚úÖ –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML –ø–µ—Ä–µ–¥ `dangerouslySetInnerHTML`
2. ‚úÖ –£–±—Ä–∞—Ç—å/–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ `/api/login`

### –í–∞–∂–Ω–æ (–≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):
4. ‚úÖ –£–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ 30-90 –¥–Ω–µ–π
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:
7. ‚úÖ CSRF —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
8. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
9. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (failed logins, etc.)

## üîí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Directus:

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å TTL —Ç–æ–∫–µ–Ω–æ–≤:**
```env
AUTH_TOKEN_TTL=3600  # 1 —á–∞—Å –¥–ª—è access token
AUTH_REFRESH_TOKEN_TTL=2592000  # 30 –¥–Ω–µ–π –¥–ª—è refresh token
```

2. **–í–∫–ª—é—á–∏—Ç—å 2FA** –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** —Å—Ç—Ä–æ–≥–æ (–ø—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)

4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å** Directus –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

